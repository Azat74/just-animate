<html>

<head>
  <title>Just Animate Demo</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
</head>

<body ng-app="app" ng-controller="showcaseCtrl as vm">
  <div class="container text-center">
    <h1>Showcase</h1>
    <hr/>

    <div id="animation-container"></div>

  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web-animations/2.1.4/web-animations.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js"></script>
  <script src="../../dist/just-animate-angular.js"></script>
  <script>
    angular.module('app', ['just.animate'])
      .controller('showcaseCtrl', function($scope, $timeout, just) {
        function playAllAnimations($container) {
                var animations = Object.keys(just)
                    .filter(function(name) {
                        return name.indexOf("_") !== 0 && name !== "animate" && name !== "register";
                    });
                
                var position = -1;
                var errors = 0;
                var passing = 0;
                
                function nextAnimation() {
                    ++position;
                    
                    // end recursive function
                    if (position >= animations.length) {
                        var $summary = $('<div></div>')
                          .addClass('alert');
                        
                        if (errors) {
                          $summary
                            .addClass('alert-danger')
                            .html('There were ' + errors + ' errors. There were ' + passing + ' passing tests.')
                        } else {
                          $summary
                            .addClass('alert-success')
                            .html('Everything is awesome. Everything is cool when your tests are all green!')
                        }
                        
                        $container.prepend($summary);
                        return;
                    }
                    
                    $timeout(function() {
                        var animationName = animations[position];
                        
                        var $el = $('<h2></h2>')
                        try {
                            $el.html(animationName);
                            just[animationName]($el);
                            ++passing;
                        } catch (err) {
                            ++errors;
                            $el = $('<pre></pre>')
                            $el.html(animationName + ": " + err);
                            $el.attr('style', 'color: red;');
                        }
                        $container.prepend($el);
                        
                        nextAnimation();
                    }, 1200);
                }
                
                nextAnimation();
            }
            
            playAllAnimations($('#animation-container'));
      });
  </script>
</body>

</html>
